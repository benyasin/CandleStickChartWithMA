{"version":3,"sources":["../../../../../src/lib/interactive/components/HoverTextNearMouse.js"],"names":["React","Component","PropTypes","GenericChartComponent","isDefined","PADDING","MIN_WIDTH","HoverTextNearMouse","props","state","textWidth","undefined","textHeight","saveNode","bind","updateTextSize","renderSVG","node","textNode","bgWidth","bgHeight","getBBox","width","height","setState","moreProps","fontFamily","fontSize","fill","bgFill","bgOpacity","textMetaData","helper","getBgWidth","getBgHeight","rect","text","x","y","numberOrString","oneOfType","number","oneOf","propTypes","string","isRequired","show","bool","defaultProps","mouseXY","chartConfig","mouseInsideCanvas","cx","cy"],"mappings":"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","file":"HoverTextNearMouse.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../../GenericChartComponent\";\nimport { isDefined } from \"../../utils\";\n\nconst PADDING = 10;\nconst MIN_WIDTH = PADDING;\n\nclass HoverTextNearMouse extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\ttextWidth: undefined,\n\t\t\ttextHeight: undefined,\n\t\t};\n\n\t\tthis.saveNode = this.saveNode.bind(this);\n\t\tthis.updateTextSize = this.updateTextSize.bind(this);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t}\n\tsaveNode(node) {\n\t\tthis.textNode = node;\n\t}\n\n\tupdateTextSize() {\n\t\tconst { bgWidth, bgHeight } = this.props;\n\t\tif (bgWidth === \"auto\" || bgHeight === \"auto\") {\n\t\t\tconst textNode = this.textNode;\n\t\t\tif (textNode) {\n\t\t\t\tconst { width, height } = textNode.getBBox();\n\t\t\t\tif (this.state.textWidth !== width || this.state.textHeight !== height) {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\ttextWidth: width,\n\t\t\t\t\t\ttextHeight: height\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.updateTextSize();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.updateTextSize();\n\t}\n\n\tgetBgWidth() {\n\t\tconst { bgWidth } = this.props;\n\t\tconst { textWidth } = this.state;\n\n\t\tif (bgWidth !== \"auto\") {\n\t\t\treturn bgWidth;\n\t\t} else if (textWidth !== undefined) {\n\t\t\treturn textWidth + PADDING;\n\t\t} else {\n\t\t\treturn MIN_WIDTH;\n\t\t}\n\t}\n\n\tgetBgHeight() {\n\t\tconst { bgHeight } = this.props;\n\t\tconst { textHeight } = this.state;\n\n\t\tif (bgHeight !== \"auto\") {\n\t\t\treturn bgHeight;\n\t\t} else if (textHeight !== undefined) {\n\t\t\treturn textHeight + PADDING;\n\t\t} else {\n\t\t\treturn MIN_WIDTH;\n\t\t}\n\t}\n\n\trenderSVG(moreProps) {\n\t\tconst {\n\t\t\tfontFamily,\n\t\t\tfontSize,\n\t\t\tfill,\n\t\t\tbgFill,\n\t\t\tbgOpacity,\n\t\t} = this.props;\n\n\t\t// console.log(moreProps)\n\t\tconst textMetaData = helper({\n\t\t\t...this.props,\n\t\t\tbgWidth: this.getBgWidth(),\n\t\t\tbgHeight: this.getBgHeight()\n\t\t}, moreProps);\n\n\t\tif (isDefined(textMetaData)) {\n\t\t\tconst { rect, text } = textMetaData;\n\t\t\treturn (\n\t\t\t\t<g>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tfill={bgFill}\n\t\t\t\t\t\tfillOpacity={bgOpacity}\n\t\t\t\t\t\tstroke={bgFill}\n\t\t\t\t\t\t{...rect}\n\t\t\t\t\t/>\n\t\t\t\t\t<text\n\t\t\t\t\t\tref={this.saveNode}\n\t\t\t\t\t\tfontSize={fontSize}\n\t\t\t\t\t\tfontFamily={fontFamily}\n\t\t\t\t\t\ttextAnchor=\"start\"\n\t\t\t\t\t\talignmentBaseline={\"central\"}\n\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\tx={text.x}\n\t\t\t\t\t\ty={text.y}>{text.text}</text>\n\t\t\t\t</g>\n\t\t\t);\n\t\t}\n\t}\n\trender() {\n\t\tconst { text } = this.props;\n\t\tif (text) {\n\t\t\treturn <GenericChartComponent\n\t\t\t\tsvgDraw={this.renderSVG}\n\t\t\t\tdrawOn={[\"mousemove\"]}\n\t\t\t/>;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nconst numberOrString = PropTypes.oneOfType([\n\tPropTypes.number,\n\tPropTypes.oneOf([\"auto\"]),\n]);\n\nHoverTextNearMouse.propTypes = {\n\tfontFamily: PropTypes.string.isRequired,\n\tfontSize: PropTypes.number.isRequired,\n\tfill: PropTypes.string.isRequired,\n\ttext: PropTypes.string.isRequired,\n\tbgFill: PropTypes.string.isRequired,\n\tbgOpacity: PropTypes.number.isRequired,\n\tbgWidth: numberOrString.isRequired,\n\tbgHeight: numberOrString.isRequired,\n\tshow: PropTypes.bool.isRequired,\n};\n\nHoverTextNearMouse.defaultProps = {\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\n\tfontSize: 12,\n\tfill: \"#000000\",\n\tbgFill: \"#FA9325\",\n\tbgOpacity: 0.5,\n};\n\nfunction helper(props, moreProps) {\n\tconst {\n\t\tshow,\n\t\tbgWidth,\n\t\tbgHeight,\n\t} = props;\n\n\tconst {\n\t\tmouseXY,\n\t\tchartConfig: { height, width },\n\t\tshow: mouseInsideCanvas\n\t} = moreProps;\n\n\tif (show && mouseInsideCanvas) {\n\t\tconst [x, y] = mouseXY;\n\n\t\tconst cx = x < width / 2\n\t\t\t? x + PADDING\n\t\t\t: x - bgWidth - PADDING;\n\n\t\tconst cy = y < height / 2\n\t\t\t? y + PADDING\n\t\t\t: y - bgHeight - PADDING;\n\n\t\tconst rect = {\n\t\t\tx: cx,\n\t\t\ty: cy,\n\t\t\twidth: bgWidth,\n\t\t\theight: bgHeight,\n\t\t};\n\n\t\tconst text = {\n\t\t\ttext: props.text,\n\t\t\tx: cx + PADDING / 2,\n\t\t\ty: cy + bgHeight / 2,\n\t\t};\n\n\t\treturn {\n\t\t\trect,\n\t\t\ttext\n\t\t};\n\t}\n}\n\nexport default HoverTextNearMouse;\n"]}