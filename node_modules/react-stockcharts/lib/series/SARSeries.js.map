{"version":3,"sources":["../../../../src/lib/series/SARSeries.js"],"names":["React","Component","PropTypes","GenericChartComponent","getAxisCanvas","getMouseCanvas","isDefined","first","last","hexToRGBA","SARSeries","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","mouseXY","currentItem","yScale","chartConfig","yAccessor","y","currentY","ctx","fill","opacity","xAccessor","plotData","xScale","hovering","width","d","length","radius","Math","min","max","forEach","centerX","each","centerY","color","close","falling","rising","fillStyle","strokeStyle","beginPath","ellipse","PI","closePath","stroke","className","filter","map","idx","highlightOnHover","hoverProps","drawOn","canvasToDraw","onClick","onDoubleClick","onContextMenu","propTypes","string","object","isRequired","func","number","bool","defaultProps","e","console","log"],"mappings":";;;;;;;;;;AAEA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,YAAtB;;AAEA,OAAOC,qBAAP,MAAkC,0BAAlC;AACA,SAASC,aAAT,EAAwBC,cAAxB,QAA8C,qBAA9C;;AAEA,SAASC,SAAT,EAAoBC,KAApB,EAA2BC,IAA3B,EAAiCC,SAAjC,QAAkD,UAAlD;;IAEMC,S;;;AACL,oBAAYC,KAAZ,EAAmB;AAAA;;AAAA,oHACZA,KADY;;AAElB,QAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeC,IAAf,OAAjB;AACA,QAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBD,IAAlB,OAApB;AACA,QAAKE,OAAL,GAAe,MAAKA,OAAL,CAAaF,IAAb,OAAf;AAJkB;AAKlB;;;;0BACOG,S,EAAW;AAAA,OACVC,OADU,GACwCD,SADxC,CACVC,OADU;AAAA,OACDC,WADC,GACwCF,SADxC,CACDE,WADC;AAAA,OAC2BC,MAD3B,GACwCH,SADxC,CACYI,WADZ,CAC2BD,MAD3B;AAAA,OAEVE,SAFU,GAEI,KAAKV,KAFT,CAEVU,SAFU;;AAGlB,OAAMC,IAAIL,QAAQ,CAAR,CAAV;AACA,OAAMM,WAAWJ,OAAOE,UAAUH,WAAV,CAAP,CAAjB;AACA,UAAOI,IAAKC,WAAW,CAAhB,IAAqBD,IAAIC,WAAW,CAA3C;AACA;;;+BACYC,G,EAAKR,S,EAAW;AAAA,gBACS,KAAKL,KADd;AAAA,OACpBU,SADoB,UACpBA,SADoB;AAAA,OACTI,IADS,UACTA,IADS;AAAA,OACHC,OADG,UACHA,OADG;AAAA,OAEpBC,SAFoB,GAE+CX,SAF/C,CAEpBW,SAFoB;AAAA,OAETC,QAFS,GAE+CZ,SAF/C,CAETY,QAFS;AAAA,OAECC,MAFD,GAE+Cb,SAF/C,CAECa,MAFD;AAAA,OAEwBV,MAFxB,GAE+CH,SAF/C,CAESI,WAFT,CAEwBD,MAFxB;AAAA,OAEkCW,QAFlC,GAE+Cd,SAF/C,CAEkCc,QAFlC;;;AAI5B,OAAMC,QAAQF,OAAOF,UAAUnB,KAAKoB,QAAL,CAAV,CAAP,IAAoCC,OAAOF,UAAUpB,MAAMqB,QAAN,CAAV,CAAP,CAAlD;;AAEA,OAAMI,IAAKD,QAAQH,SAASK,MAAlB,GAA4B,GAA5B,GAAkC,CAA5C;AACA,OAAMC,SAASC,KAAKC,GAAL,CAAS,CAAT,EAAYD,KAAKE,GAAL,CAAS,GAAT,EAAeL,CAAf,CAAZ,KAAkCF,WAAW,CAAX,GAAe,CAAjD,CAAf;;AAEAF,YAASU,OAAT,CAAiB,gBAAQ;AACxB,QAAMC,UAAUV,OAAOF,UAAUa,IAAV,CAAP,CAAhB;AACA,QAAMC,UAAUtB,OAAOE,UAAUmB,IAAV,CAAP,CAAhB;AACA,QAAME,QAAQrB,UAAUmB,IAAV,IAAkBA,KAAKG,KAAvB,GACXlB,KAAKmB,OADM,GAEXnB,KAAKoB,MAFR;;AAIArB,QAAIsB,SAAJ,GAAgBrC,UAAUiC,KAAV,EAAiBhB,OAAjB,CAAhB;AACAF,QAAIuB,WAAJ,GAAkBL,KAAlB;;AAEAlB,QAAIwB,SAAJ;AACAxB,QAAIyB,OAAJ,CAAYV,OAAZ,EAAqBE,OAArB,EAA8BP,MAA9B,EAAsCA,MAAtC,EAA8C,CAA9C,EAAiD,CAAjD,EAAoD,IAAIC,KAAKe,EAA7D;AACA1B,QAAI2B,SAAJ;AACA3B,QAAIC,IAAJ;AACAD,QAAI4B,MAAJ;AACA,IAfD;AAgBA;;;4BACSpC,S,EAAW;AAAA,iBACa,KAAKL,KADlB;AAAA,OACZ0C,SADY,WACZA,SADY;AAAA,OACDhC,SADC,WACDA,SADC;AAAA,OAEZM,SAFY,GAE6CX,SAF7C,CAEZW,SAFY;AAAA,OAEDC,QAFC,GAE6CZ,SAF7C,CAEDY,QAFC;AAAA,OAESC,MAFT,GAE6Cb,SAF7C,CAESa,MAFT;AAAA,OAEgCV,MAFhC,GAE6CH,SAF7C,CAEiBI,WAFjB,CAEgCD,MAFhC;AAGpB;;AAEA,UAAO;AAAA;AAAA,MAAG,WAAWkC,SAAd;AACLzB,aACC0B,MADD,CACQ;AAAA,YAAQhD,UAAUe,UAAUmB,IAAV,CAAV,CAAR;AAAA,KADR,EAECe,GAFD,CAEK,UAACf,IAAD,EAAOgB,GAAP,EAAe;AACnB,YAAO,gCAAQ,KAAKA,GAAb,EAAkB,IAAI3B,OAAOF,UAAUa,IAAV,CAAP,CAAtB;AACN,UAAIrB,OAAOE,UAAUmB,IAAV,CAAP,CADE,EACuB,GAAG,CAD1B,EAC6B,MAAK,OADlC,GAAP;AAEA,KALD;AADK,IAAP;AAQA;;;2BAEQ;AAAA,OACAiB,gBADA,GACqB,KAAK9C,KAD1B,CACA8C,gBADA;;AAER,OAAMC,aAAaD,mBAChB;AACD1C,aAAS,KAAKA,OADb;AAED4C,YAAQ,CAAC,WAAD,EAAc,KAAd,CAFP;AAGDC,kBAAcvD;AAHb,IADgB,GAMhB;AACDsD,YAAQ,CAAC,KAAD,CADP;AAEDC,kBAAcxD;AAFb,IANH;;AAWA,UAAO,oBAAC,qBAAD;AACN,aAAS,KAAKQ,SADR;;AAGN,gBAAY,KAAKE,YAHX;;AAKN,sBAAkB,KAAKH,KAAL,CAAWkD,OALvB;AAMN,4BAAwB,KAAKlD,KAAL,CAAWmD,aAN7B;AAON,4BAAwB,KAAKnD,KAAL,CAAWoD;AAP7B,MAQFL,UARE,EAAP;AAUA;;;;EA9EsBzD,S;;AAiFxBS,UAAUsD,SAAV,GAAsB;AACrBX,YAAWnD,UAAU+D,MADA;AAErBxC,OAAMvB,UAAUgE,MAAV,CAAiBC,UAFF;AAGrB9C,YAAWnB,UAAUkE,IAAV,CAAeD,UAHL;AAIrBzC,UAASxB,UAAUmE,MAAV,CAAiBF,UAJL;AAKrBN,UAAS3D,UAAUkE,IALE;AAMrBN,gBAAe5D,UAAUkE,IANJ;AAOrBL,gBAAe7D,UAAUkE,IAPJ;AAQrBX,mBAAkBvD,UAAUoE;AARP,CAAtB;;AAWA5D,UAAU6D,YAAV,GAAyB;AACxBlB,YAAW,uBADa;AAExB5B,OAAM;AACLmB,WAAS,SADJ;AAELC,UAAQ;AAFH,EAFkB;AAMxBY,mBAAkB,IANM;AAOxB/B,UAAS,GAPe;AAQxBmC,UAAS,iBAASW,CAAT,EAAY;AAAEC,UAAQC,GAAR,CAAY,OAAZ,EAAqBF,CAArB;AAA0B,EARzB;AASxBV,gBAAe,uBAASU,CAAT,EAAY;AAAEC,UAAQC,GAAR,CAAY,cAAZ,EAA4BF,CAA5B;AAAiC,EATtC;AAUxBT,gBAAe,uBAASS,CAAT,EAAY;AAAEC,UAAQC,GAAR,CAAY,aAAZ,EAA2BF,CAA3B;AAAgC;AAVrC,CAAzB;;AAaA,eAAe9D,SAAf","file":"SARSeries.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getAxisCanvas, getMouseCanvas } from \"../GenericComponent\";\n\nimport { isDefined, first, last, hexToRGBA } from \"../utils\";\n\nclass SARSeries extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t\tthis.isHover = this.isHover.bind(this);\n\t}\n\tisHover(moreProps) {\n\t\tconst { mouseXY, currentItem, chartConfig: { yScale } } = moreProps;\n\t\tconst { yAccessor } = this.props;\n\t\tconst y = mouseXY[1];\n\t\tconst currentY = yScale(yAccessor(currentItem));\n\t\treturn y <  currentY + 5 && y > currentY - 5;\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { yAccessor, fill, opacity } = this.props;\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale }, hovering } = moreProps;\n\n\t\tconst width = xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)));\n\n\t\tconst d = (width / plotData.length) * 0.5 / 2;\n\t\tconst radius = Math.min(2, Math.max(0.5,  d)) + (hovering ? 2 : 0);\n\n\t\tplotData.forEach(each => {\n\t\t\tconst centerX = xScale(xAccessor(each));\n\t\t\tconst centerY = yScale(yAccessor(each));\n\t\t\tconst color = yAccessor(each) > each.close\n\t\t\t\t? fill.falling\n\t\t\t\t: fill.rising;\n\n\t\t\tctx.fillStyle = hexToRGBA(color, opacity);\n\t\t\tctx.strokeStyle = color;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.ellipse(centerX, centerY, radius, radius, 0, 0, 2 * Math.PI);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\t\t});\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { className, yAccessor } = this.props;\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale } } = moreProps;\n\t\t// console.log(moreProps);\n\n\t\treturn <g className={className}>\n\t\t\t{plotData\n\t\t\t\t.filter(each => isDefined(yAccessor(each)))\n\t\t\t\t.map((each, idx) => {\n\t\t\t\t\treturn <circle key={idx} cx={xScale(xAccessor(each))}\n\t\t\t\t\t\tcy={yScale(yAccessor(each))} r={3} fill=\"green\" />;\n\t\t\t\t})}\n\t\t</g>;\n\t}\n\n\trender() {\n\t\tconst { highlightOnHover } = this.props;\n\t\tconst hoverProps = highlightOnHover\n\t\t\t? {\n\t\t\t\tisHover: this.isHover,\n\t\t\t\tdrawOn: [\"mousemove\", \"pan\"],\n\t\t\t\tcanvasToDraw: getMouseCanvas\n\t\t\t}\n\t\t\t: {\n\t\t\t\tdrawOn: [\"pan\"],\n\t\t\t\tcanvasToDraw: getAxisCanvas\n\t\t\t};\n\n\t\treturn <GenericChartComponent\n\t\t\tsvgDraw={this.renderSVG}\n\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\n\t\t\tonClickWhenHover={this.props.onClick}\n\t\t\tonDoubleClickWhenHover={this.props.onDoubleClick}\n\t\t\tonContextMenuWhenHover={this.props.onContextMenu}\n\t\t\t{...hoverProps}\n\t\t/>;\n\t}\n}\n\nSARSeries.propTypes = {\n\tclassName: PropTypes.string,\n\tfill: PropTypes.object.isRequired,\n\tyAccessor: PropTypes.func.isRequired,\n\topacity: PropTypes.number.isRequired,\n\tonClick: PropTypes.func,\n\tonDoubleClick: PropTypes.func,\n\tonContextMenu: PropTypes.func,\n\thighlightOnHover: PropTypes.bool,\n};\n\nSARSeries.defaultProps = {\n\tclassName: \"react-stockcharts-sar\",\n\tfill: {\n\t\tfalling: \"#4682B4\",\n\t\trising: \"#15EC2E\",\n\t},\n\thighlightOnHover: true,\n\topacity: 0.2,\n\tonClick: function(e) { console.log(\"Click\", e); },\n\tonDoubleClick: function(e) { console.log(\"Double Click\", e); },\n\tonContextMenu: function(e) { console.log(\"Right Click\", e); },\n};\n\nexport default SARSeries;\n"]}