{"version":3,"sources":["../../../src/lib/EventCapture.js"],"names":["React","Component","PropTypes","select","event","d3Event","mouse","touches","isDefined","mousePosition","touchPosition","getTouchProps","d3Window","MOUSEMOVE","MOUSEUP","MOUSEENTER","MOUSELEAVE","TOUCHMOVE","TOUCHEND","noop","getCurrentCharts","EventCapture","props","handleEnter","bind","handleLeave","handleWheel","handleMouseMove","handleMouseDown","handlePanEnd","handlePan","handleTouchStart","handleTouchMove","handlePinchZoom","handlePinchZoomEnd","handleClick","handleRightClick","handleDrag","handleDragEnd","shouldPan","canPan","setCursorClass","saveNode","mouseInside","mouseInteraction","state","panInProgress","node","focus","on","componentDidMount","win","e","onMouseEnter","dragInProgress","onMouseLeave","zoom","onZoom","yZoom","Math","abs","deltaY","deltaX","mouseXY","preventDefault","zoomDir","panStart","panStartXScale","chartsToPan","lastNewPos","panHappened","dx","dy","dxdy","onPan","xScale","chartConfig","currentCharts","setState","panOrigin","queuePanEnd","panEndTimeout","clearTimeout","setTimeout","onMouseMove","mouseMove","newPos","onClick","onDoubleClick","dragHappened","clicked","stopPropagation","onContextMenu","onPanEnd","getBoundingClientRect","onDrag","startPos","dragStartPosition","onDragComplete","getAllPanConditions","initialPanEnabled","pan","reduce","returnObj","a","draggable","panEnabled","somethingSelected","button","onMouseDown","onDragStart","touchXY","length","touch1Pos","touch2Pos","pinchZoomStart","range","zoomEnabled","onPinchZoom","initialPinch","onPinchZoomEnd","cursorOverrideClass","height","width","id","disableInteraction","useCrossHairStyleCursor","className","interactionProps","onWheel","onTouchStart","onTouchMove","opacity","propTypes","bool","isRequired","panSpeedMultiplier","number","array","func","xAccessor","children","defaultProps"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,MAAT,EAAiBC,SAASC,OAA1B,EAAmCC,KAAnC,EAA0CC,OAA1C,QAAyD,cAAzD;;AAEA,SACIC,SADJ,EACeC,aADf,EAC8BC,aAD9B,EAC6CC,aAD7C,EAEIC,QAFJ,EAGIC,SAHJ,EAGeC,OAHf,EAIIC,UAJJ,EAIgBC,UAJhB,EAKIC,SALJ,EAKeC,QALf,EAMIC,IANJ,QAOO,SAPP;AAQA,SAASC,gBAAT,QAAiC,uBAAjC;;AAEA;;IAEMC,Y;;;AACF,0BAAYC,KAAZ,EAAmB;AAAA;;AAAA,gIACTA,KADS;;AAEf,cAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,OAAnB;AACA,cAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBD,IAAjB,OAAnB;AACA,cAAKE,WAAL,GAAmB,MAAKA,WAAL,CAAiBF,IAAjB,OAAnB;AACA,cAAKG,eAAL,GAAuB,MAAKA,eAAL,CAAqBH,IAArB,OAAvB;AACA,cAAKI,eAAL,GAAuB,MAAKA,eAAL,CAAqBJ,IAArB,OAAvB;AACA,cAAKK,YAAL,GAAoB,MAAKA,YAAL,CAAkBL,IAAlB,OAApB;AACA,cAAKM,SAAL,GAAiB,MAAKA,SAAL,CAAeN,IAAf,OAAjB;AACA,cAAKO,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBP,IAAtB,OAAxB;AACA,cAAKQ,eAAL,GAAuB,MAAKA,eAAL,CAAqBR,IAArB,OAAvB;AACA,cAAKS,eAAL,GAAuB,MAAKA,eAAL,CAAqBT,IAArB,OAAvB;AACA,cAAKU,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBV,IAAxB,OAA1B;;AAEA,cAAKW,WAAL,GAAmB,MAAKA,WAAL,CAAiBX,IAAjB,OAAnB;;AAEA,cAAKY,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBZ,IAAtB,OAAxB;AACA,cAAKa,UAAL,GAAkB,MAAKA,UAAL,CAAgBb,IAAhB,OAAlB;AACA,cAAKc,aAAL,GAAqB,MAAKA,aAAL,CAAmBd,IAAnB,OAArB;;AAEA,cAAKe,SAAL,GAAiB,MAAKA,SAAL,CAAef,IAAf,OAAjB;AACA,cAAKgB,MAAL,GAAc,MAAKA,MAAL,CAAYhB,IAAZ,OAAd;;AAEA,cAAKiB,cAAL,GAAsB,MAAKA,cAAL,CAAoBjB,IAApB,OAAtB;AACA,cAAKkB,QAAL,GAAgB,MAAKA,QAAL,CAAclB,IAAd,OAAhB;;AAEA,cAAKmB,WAAL,GAAmB,KAAnB;;AAEA,cAAKC,gBAAL,GAAwB,IAAxB;AACA,cAAKC,KAAL,GAAa;AACTC,2BAAe;AADN,SAAb;AA7Be;AAgClB;;;;iCAEQC,I,EAAM;AACX,iBAAKA,IAAL,GAAYA,IAAZ;AACH;;;6CAEoB;AACjB,iBAAKC,KAAL,GAAa,KAAK1B,KAAL,CAAW0B,KAAxB;AACH;;;4CAEmB;AAChB,gBAAI,KAAKD,IAAT,EAAe;AACX5C,uBAAO,KAAK4C,IAAZ,EACKE,EADL,CACQlC,UADR,EACoB,KAAKQ,WADzB,EAEK0B,EAFL,CAEQjC,UAFR,EAEoB,KAAKS,WAFzB;AAGH;AACJ;;;6CAEoB;AACjB,iBAAKyB,iBAAL;AACH;;;+CAEsB;AACnB,gBAAI,KAAKH,IAAT,EAAe;AACX5C,uBAAO,KAAK4C,IAAZ,EACKE,EADL,CACQlC,UADR,EACoB,IADpB,EAEKkC,EAFL,CAEQjC,UAFR,EAEoB,IAFpB;AAGA,oBAAMmC,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,uBAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,IADnB;AAEH;AACJ;;;sCAEa;AACV,gBAAMuC,IAAI/C,OAAV;;AADU,gBAGFgD,YAHE,GAGe,KAAK/B,KAHpB,CAGF+B,YAHE;;AAIV,iBAAKV,WAAL,GAAmB,IAAnB;AACA,gBAAI,CAAC,KAAKE,KAAL,CAAWC,aAAZ,IACG,CAAC,KAAKD,KAAL,CAAWS,cADnB,EACmC;AAC/B,oBAAMH,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,uBAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,KAAKc,eADxB;AAEH;AACD0B,yBAAaD,CAAb;AACH;;;oCAEWA,C,EAAG;AAAA,gBACHG,YADG,GACc,KAAKjC,KADnB,CACHiC,YADG;;AAEX,iBAAKZ,WAAL,GAAmB,KAAnB;AACA,gBAAI,CAAC,KAAKE,KAAL,CAAWC,aAAZ,IACG,CAAC,KAAKD,KAAL,CAAWS,cADnB,EACmC;AAC/B,oBAAMH,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,uBAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,IADnB;AAEH;AACD0C,yBAAaH,CAAb;AACH;;;oCAEWA,C,EAAG;AAAA,yBACc,KAAK9B,KADnB;AAAA,gBACHkC,IADG,UACHA,IADG;AAAA,gBACGC,MADH,UACGA,MADH;AAAA,gBAEHX,aAFG,GAEe,KAAKD,KAFpB,CAEHC,aAFG;;;AAIX,gBAAMY,QAAQC,KAAKC,GAAL,CAASR,EAAES,MAAX,IAAqBF,KAAKC,GAAL,CAASR,EAAEU,MAAX,CAArB,IAA2CH,KAAKC,GAAL,CAASR,EAAES,MAAX,IAAqB,CAA9E;AACA;AACA,gBAAME,UAAUtD,cAAc2C,CAAd,CAAhB;AACAA,cAAEY,cAAF;;AAEA,gBAAIR,QAAQ,KAAKR,KAAb,IAAsBU,KAAtB,IAA+B,CAACZ,aAApC,EAAmD;AAC/C,oBAAMmB,UAAUb,EAAES,MAAF,GAAW,CAAX,GAAe,CAAf,GAAmB,CAAC,CAApC;;AAEAJ,uBAAOQ,OAAP,EAAgBF,OAAhB,EAAyBX,CAAzB;AACH,aAJD,MAIO,IAAI,KAAKJ,KAAT,EAAgB;AACnB,oBAAI,KAAKT,SAAL,EAAJ,EAAsB;AAClB;AACA;AAFkB,0CAMd,KAAKM,KAAL,CAAWqB,QANG;AAAA,wBAIdC,cAJc,mBAIdA,cAJc;AAAA,wBAKdC,WALc,mBAKdA,WALc;;AAOlB,yBAAKC,UAAL,GAAkBN,OAAlB;AACA,yBAAKO,WAAL,GAAmB,IAAnB;;AAEA,yBAAKC,EAAL,IAAWnB,EAAEU,MAAb;AACA,yBAAKU,EAAL,IAAWpB,EAAES,MAAb;AACA,wBAAMY,OAAO,EAAEF,IAAI,KAAKA,EAAX,EAAeC,IAAI,KAAKA,EAAxB,EAAb;;AAEA,yBAAKlD,KAAL,CAAWoD,KAAX,CAAiBX,OAAjB,EAA0BI,cAA1B,EAA0CM,IAA1C,EAAgDL,WAAhD,EAA6DhB,CAA7D;AACH,iBAfD,MAeO;AACH;AACA;;AAFG,kCAI6B,KAAK9B,KAJlC;AAAA,wBAIKqD,MAJL,WAIKA,MAJL;AAAA,wBAIaC,WAJb,WAIaA,WAJb;;AAKH,wBAAMC,gBAAgBzD,iBAAiBwD,WAAjB,EAA8Bb,OAA9B,CAAtB;;AAEA,yBAAKQ,EAAL,GAAU,CAAV;AACA,yBAAKC,EAAL,GAAU,CAAV;AACA,yBAAKM,QAAL,CAAc;AACVhC,uCAAe,IADL;AAEVoB,kCAAU;AACNC,4CAAgBQ,MADV;AAENI,uCAAWhB,OAFL;AAGNK,yCAAaS;AAHP;AAFA,qBAAd;AAQH;AACD,qBAAKG,WAAL;AACH;AACJ;;;sCAEa;AAAA;;AACV,gBAAIxE,UAAU,KAAKyE,aAAf,CAAJ,EAAmC;AAC/BC,6BAAa,KAAKD,aAAlB;AACH;AACD,iBAAKA,aAAL,GAAqBE,WAAW,YAAM;AAClC,uBAAKtD,YAAL;AACH,aAFoB,EAElB,GAFkB,CAArB;AAGH;;;0CAEiB;AACd,gBAAMuB,IAAI/C,OAAV;;AADc,0BAGqB,KAAKiB,KAH1B;AAAA,gBAGN8D,WAHM,WAGNA,WAHM;AAAA,gBAGOC,SAHP,WAGOA,SAHP;;;AAKd,gBAAI,KAAKzC,gBAAL,IACGyC,SADH,IAEG,CAAC,KAAKxC,KAAL,CAAWC,aAFnB,EAEkC;;AAE9B,oBAAMwC,SAAShF,MAAM,KAAKyC,IAAX,CAAf;;AAEAqC,4BAAYE,MAAZ,EAAoB,OAApB,EAA6BlC,CAA7B;AACH;AACJ;;;oCAEWA,C,EAAG;AAAA;;AACX,gBAAMW,UAAUtD,cAAc2C,CAAd,CAAhB;AADW,0BAEwB,KAAK9B,KAF7B;AAAA,gBAEHiE,OAFG,WAEHA,OAFG;AAAA,gBAEMC,aAFN,WAEMA,aAFN;;;AAIX,gBAAI,CAAC,KAAKlB,WAAN,IAAqB,CAAC,KAAKmB,YAA/B,EAA6C;AACzC,oBAAI,KAAKC,OAAT,EAAkB;AACdF,kCAAczB,OAAd,EAAuBX,CAAvB;AACA,yBAAKsC,OAAL,GAAe,KAAf;AACH,iBAHD,MAGO;AACHH,4BAAQxB,OAAR,EAAiBX,CAAjB;AACA,yBAAKsC,OAAL,GAAe,IAAf;AACAP,+BAAW,YAAM;AACb,4BAAI,OAAKO,OAAT,EAAkB;AACd,mCAAKA,OAAL,GAAe,KAAf;AACH;AACJ,qBAJD,EAIG,GAJH;AAKH;AACJ;AACJ;;;yCAEgBtC,C,EAAG;AAChBA,cAAEuC,eAAF;AACAvC,cAAEY,cAAF;AAFgB,0BAGoB,KAAK1C,KAHzB;AAAA,gBAGRsE,aAHQ,WAGRA,aAHQ;AAAA,gBAGOC,QAHP,WAGOA,QAHP;;;AAKhB,gBAAM9B,UAAUtD,cAAc2C,CAAd,EAAiB,KAAKL,IAAL,CAAU+C,qBAAV,EAAjB,CAAhB;;AAEA,gBAAItF,UAAU,KAAKqC,KAAL,CAAWqB,QAArB,CAAJ,EAAoC;AAAA,uCACmB,KAAKrB,KAAL,CAAWqB,QAD9B;AAAA,oBACxBC,cADwB,oBACxBA,cADwB;AAAA,oBACRY,SADQ,oBACRA,SADQ;AAAA,oBACGX,WADH,oBACGA,WADH;;AAEhC,oBAAI,KAAKE,WAAT,EAAsB;AAClBuB,6BAAS9B,OAAT,EAAkBI,cAAlB,EAAkCY,SAAlC,EAA6CX,WAA7C,EAA0DhB,CAA1D;AACH;AACD,oBAAMD,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,uBAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,IADnB,EAEKoC,EAFL,CAEQnC,OAFR,EAEiB,IAFjB;;AAIA,qBAAKgE,QAAL,CAAc;AACVhC,mCAAe,KADL;AAEVoB,8BAAU;AAFA,iBAAd;AAIH;;AAED0B,0BAAc7B,OAAd,EAAuBX,CAAvB;AACH;;;qCAEY;AACT,gBAAMA,IAAI/C,OAAV;AACA,gBAAI,KAAKiB,KAAL,CAAWyE,MAAf,EAAuB;AACnB,qBAAKN,YAAL,GAAoB,IAApB;AACA,oBAAM1B,UAAUzD,MAAM,KAAKyC,IAAX,CAAhB;AACA,qBAAKzB,KAAL,CAAWyE,MAAX,CAAkB;AACdC,8BAAU,KAAKnD,KAAL,CAAWoD,iBADP;AAEdlC;AAFc,iBAAlB,EAGGX,CAHH;AAIH;AACJ;;;qCAEY;AACT,gBAAMD,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,mBAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,KAAK8B,WAAL,GAAmB,KAAKhB,eAAxB,GAA0C,IAD7D,EAEKsB,EAFL,CAEQnC,OAFR,EAEiB,IAFjB;;AAIA,iBAAKgE,QAAL,CAAc;AACVxB,gCAAgB;AADN,aAAd;AAGA,iBAAKV,gBAAL,GAAwB,IAAxB;AACH;;;wCAEe;AACZ,gBAAMQ,IAAI/C,OAAV;AACA,gBAAM0D,UAAUzD,MAAM,KAAKyC,IAAX,CAAhB;;AAEA,gBAAMI,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,mBAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,KAAK8B,WAAL,GAAmB,KAAKhB,eAAxB,GAA0C,IAD7D,EAEKsB,EAFL,CAEQnC,OAFR,EAEiB,IAFjB;;AAIA,gBAAI,KAAK2E,YAAT,EAAuB;AACnB,qBAAKnE,KAAL,CAAW4E,cAAX,CAA0B;AACtBnC;AADsB,iBAA1B,EAEGX,CAFH;AAGH;;AAED,iBAAK0B,QAAL,CAAc;AACVxB,gCAAgB;AADN,aAAd;AAGA,iBAAKV,gBAAL,GAAwB,IAAxB;AACH;;;iCAEQ;AAAA,gBACGuD,mBADH,GAC2B,KAAK7E,KADhC,CACG6E,mBADH;AAAA,gBAEQC,iBAFR,GAE8B,KAAK9E,KAFnC,CAEG+E,GAFH;;AAAA,wCAODF,sBACCG,MADD,CACQ,UAACC,SAAD,EAAYC,CAAZ,EAAkB;AACtB,uBAAO;AACHC,+BAAWF,UAAUE,SAAV,IAAuBD,EAAEC,SADjC;AAEHC,gCAAYH,UAAUG,UAAV,IAAwBF,EAAEE;AAFnC,iBAAP;AAIH,aAND,EAMG;AACCD,2BAAW,KADZ;AAECC,4BAAYN;AAFb,aANH,CAPC;AAAA,gBAKDM,UALC,yBAKDA,UALC;AAAA,gBAMUC,iBANV,yBAMDF,SANC;;AAkBL,mBAAO;AACHC,sCADG;AAEHC;AAFG,aAAP;AAIH;;;wCAEevD,C,EAAG;AACf,gBAAIA,EAAEwD,MAAF,KAAa,CAAjB,EAAoB;AAChB;AACH;AAHc,0BAI8B,KAAKtF,KAJnC;AAAA,gBAIPqD,MAJO,WAIPA,MAJO;AAAA,gBAICC,WAJD,WAICA,WAJD;AAAA,gBAIciC,WAJd,WAIcA,WAJd;;;AAMf,iBAAKvC,WAAL,GAAmB,KAAnB;AACA,iBAAKmB,YAAL,GAAoB,KAApB;AACA,iBAAKzC,KAAL,GAAa,IAAb;;AAEA,gBAAI,CAAC,KAAKH,KAAL,CAAWC,aAAZ,IACG,KAAKF,gBADZ,EAEE;;AAEE,oBAAMmB,UAAUtD,cAAc2C,CAAd,CAAhB;AACA,oBAAMyB,gBAAgBzD,iBAAiBwD,WAAjB,EAA8Bb,OAA9B,CAAtB;;AAHF,8BAMM,KAAKvB,MAAL,EANN;AAAA,oBAKMkE,UALN,WAKMA,UALN;AAAA,oBAKkBC,iBALlB,WAKkBA,iBALlB;;AAOE,oBAAMN,MAAMK,cAAc,CAACC,iBAA3B;;AAEA,oBAAIN,GAAJ,EAAS;AACL,yBAAKvB,QAAL,CAAc;AACVhC,uCAAeuD,GADL;AAEVnC,kCAAU;AACNC,4CAAgBQ,MADV;AAENI,uCAAWhB,OAFL;AAGNK,yCAAaS;AAHP;AAFA,qBAAd;;AASA,wBAAM1B,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,2BAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,KAAKiB,SADxB,EAEKmB,EAFL,CAEQnC,OAFR,EAEiB,KAAKe,YAFtB;AAIH,iBAfD,MAeO,IAAI8E,iBAAJ,EAAuB;AAC1B,yBAAK7B,QAAL,CAAc;AACVhC,uCAAe,KADL;AAEVQ,wCAAgB,IAFN;AAGVY,kCAAU,IAHA;AAIV+B,2CAAmBlC;AAJT,qBAAd;AAMA,yBAAKzC,KAAL,CAAWwF,WAAX,CAAuB,EAAEd,UAAUjC,OAAZ,EAAvB,EAA8CX,CAA9C;AACA;;AAEA,wBAAMD,OAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,2BAAOgD,IAAP,EACKF,EADL,CACQpC,SADR,EACmB,KAAKwB,UADxB,EAEKY,EAFL,CAEQnC,OAFR,EAEiB,KAAKwB,aAFtB;AAGH;;AAEDuE,4BAAY9C,OAAZ,EAAqBc,aAArB,EAAoCzB,CAApC;AACH;AACDA,cAAEY,cAAF;AACH;;;oCAEW;AAAA,0BAC2B,KAAK1C,KADhC;AAAA,gBACKoF,UADL,WACAL,GADA;AAAA,gBACiB3B,KADjB,WACiBA,KADjB;;AAER,mBAAOgC,cACAhC,KADA,IAEAlE,UAAU,KAAKqC,KAAL,CAAWqB,QAArB,CAFP;AAGH;;;oCAEW;AACR,gBAAMd,IAAI/C,OAAV;;AAEA,gBAAI,KAAKkC,SAAL,EAAJ,EAAsB;AAClB,qBAAK+B,WAAL,GAAmB,IAAnB;;AADkB,uCAGiC,KAAKzB,KAAL,CAAWqB,QAH5C;AAAA,oBAGVC,cAHU,oBAGVA,cAHU;AAAA,oBAGMY,SAHN,oBAGMA,SAHN;AAAA,oBAGiBX,WAHjB,oBAGiBA,WAHjB;;;AAKlB,oBAAML,UAAU,KAAKnB,gBAAL,GACVtC,MAAM,KAAKyC,IAAX,CADU,GAEVxC,QAAQ,KAAKwC,IAAb,EAAmB,CAAnB,CAFN;;AAIA,qBAAKsB,UAAL,GAAkBN,OAAlB;AACA,oBAAMQ,KAAKR,QAAQ,CAAR,IAAagB,UAAU,CAAV,CAAxB;AACA,oBAAMP,KAAKT,QAAQ,CAAR,IAAagB,UAAU,CAAV,CAAxB;;AAEA,qBAAKR,EAAL,GAAUA,EAAV;AACA,qBAAKC,EAAL,GAAUA,EAAV;;AAEA,qBAAKlD,KAAL,CAAWoD,KAAX,CACIX,OADJ,EACaI,cADb,EAC6B,EAAEI,MAAF,EAAMC,MAAN,EAD7B,EACyCJ,WADzC,EACsDhB,CADtD;AAGH;AACJ;;;uCAEc;AACX,gBAAMA,IAAI/C,OAAV;AADW,0BAE2B,KAAKiB,KAFhC;AAAA,gBAEEoF,UAFF,WAEHL,GAFG;AAAA,gBAEcR,QAFd,WAEcA,QAFd;;;AAIX,gBAAIrF,UAAU,KAAKqC,KAAL,CAAWqB,QAArB,CAAJ,EAAoC;AAAA,uCACQ,KAAKrB,KAAL,CAAWqB,QADnB;AAAA,oBACxBC,cADwB,oBACxBA,cADwB;AAAA,oBACRC,WADQ,oBACRA,WADQ;;;AAGhC,oBAAMjB,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,uBAAOgD,GAAP,EACKF,EADL,CACQpC,SADR,EACmB,KAAK8B,WAAL,GAAmB,KAAKhB,eAAxB,GAA0C,IAD7D,EAEKsB,EAFL,CAEQnC,OAFR,EAEiB,IAFjB,EAGKmC,EAHL,CAGQhC,SAHR,EAGmB,IAHnB,EAIKgC,EAJL,CAIQ/B,QAJR,EAIkB,IAJlB;;AAMA,oBAAI,KAAKoD;AACL;AADA,mBAEGoC,UAFH,IAGGb,QAHP,EAGiB;AAAA,wBACLtB,EADK,GACM,IADN,CACLA,EADK;AAAA,wBACDC,EADC,GACM,IADN,CACDA,EADC;;AAGb;;AACA,2BAAO,KAAKD,EAAZ;AACA,2BAAO,KAAKC,EAAZ;AACAqB,6BAAS,KAAKxB,UAAd,EAA0BF,cAA1B,EAA0C,EAAEI,MAAF,EAAMC,MAAN,EAA1C,EAAsDJ,WAAtD,EAAmEhB,CAAnE;AACH;;AAED,qBAAK0B,QAAL,CAAc;AACVhC,mCAAe,KADL;AAEVoB,8BAAU;AAFA,iBAAd;AAIH;AACJ;;;wCAEed,C,EAAG;AAAA,gBACPgC,WADO,GACS,KAAK9D,KADd,CACP8D,WADO;;AAEf,gBAAM2B,UAAUrG,cAAcC,cAAcyC,EAAE7C,OAAF,CAAU,CAAV,CAAd,CAAd,EAA2C6C,CAA3C,CAAhB;AACAgC,wBAAY2B,OAAZ,EAAqB,OAArB,EAA8B3D,CAA9B;AACH;;;yCAEgBA,C,EAAG;AAChB,iBAAKR,gBAAL,GAAwB,KAAxB;;AADgB,0BAGsC,KAAKtB,KAH3C;AAAA,gBAGHoF,UAHG,WAGRL,GAHQ;AAAA,gBAGSzB,WAHT,WAGSA,WAHT;AAAA,gBAGsBQ,WAHtB,WAGsBA,WAHtB;AAAA,2BAIa,KAAK9D,KAJlB;AAAA,gBAIRqD,MAJQ,YAIRA,MAJQ;AAAA,gBAIAkB,QAJA,YAIAA,QAJA;;;AAMhB,gBAAIzC,EAAE7C,OAAF,CAAUyG,MAAV,KAAqB,CAAzB,EAA4B;;AAExB,qBAAK1C,WAAL,GAAmB,KAAnB;AACA,oBAAMyC,UAAUrG,cAAcC,cAAcyC,EAAE7C,OAAF,CAAU,CAAV,CAAd,CAAd,EAA2C6C,CAA3C,CAAhB;AACAgC,4BAAY2B,OAAZ,EAAqB,OAArB,EAA8B3D,CAA9B;;AAEA,oBAAIsD,UAAJ,EAAgB;AACZ,wBAAM7B,gBAAgBzD,iBAAiBwD,WAAjB,EAA8BmC,OAA9B,CAAtB;;AAEA,yBAAKjC,QAAL,CAAc;AACVhC,uCAAe,IADL;AAEVoB,kCAAU;AACNC,4CAAgBQ,MADV;AAENI,uCAAWgC,OAFL;AAGN3C,yCAAaS;AAHP;AAFA,qBAAd;;AASA,wBAAM1B,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,2BAAOgD,GAAP,EACKF,EADL,CACQhC,SADR,EACmB,KAAKa,SADxB,EACmC,KADnC,EAEKmB,EAFL,CAEQ/B,QAFR,EAEkB,KAAKW,YAFvB,EAEqC,KAFrC;AAIH;AACJ,aAxBD,MAwBO,IAAIuB,EAAE7C,OAAF,CAAUyG,MAAV,KAAqB,CAAzB,EAA4B;AAC/B;AACA;AAF+B,6BAGK,KAAKnE,KAHV;AAAA,oBAGvBC,aAHuB,UAGvBA,aAHuB;AAAA,oBAGRoB,QAHQ,UAGRA,QAHQ;;;AAK/B,oBAAIpB,iBAAiB4D,UAAjB,IAA+Bb,QAAnC,EAA6C;AAAA,wBACjC1B,cADiC,GACUD,QADV,CACjCC,cADiC;AAAA,wBACjBY,SADiB,GACUb,QADV,CACjBa,SADiB;AAAA,wBACNX,WADM,GACUF,QADV,CACNE,WADM;;;AAGzC,wBAAMjB,QAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,2BAAOgD,KAAP,EACKF,EADL,CACQpC,SADR,EACmB,KAAK8B,WAAL,GAAmB,KAAKhB,eAAxB,GAA0C,IAD7D,EAEKsB,EAFL,CAEQnC,OAFR,EAEiB,IAFjB,EAGKmC,EAHL,CAGQhC,SAHR,EAGmB,KAAKgB,eAHxB,EAGyC,KAHzC,EAIKgB,EAJL,CAIQ/B,QAJR,EAIkB,KAAKgB,kBAJvB,EAI2C,KAJ3C;;AAMA,wBAAM+E,YAAYvG,cAAcC,cAAcyC,EAAE7C,OAAF,CAAU,CAAV,CAAd,CAAd,EAA2C6C,CAA3C,CAAlB;AACA,wBAAM8D,YAAYxG,cAAcC,cAAcyC,EAAE7C,OAAF,CAAU,CAAV,CAAd,CAAd,EAA2C6C,CAA3C,CAAlB;;AAEA,wBAAI,KAAKkB;AACL;AADA,uBAEGoC,UAFH,IAGGb,QAHP,EAGiB;;AAEbA,iCAAS,KAAKxB,UAAd,EAA0BF,cAA1B,EAA0CY,SAA1C,EAAqDX,WAArD,EAAkEhB,CAAlE;AACH;;AAED,yBAAK0B,QAAL,CAAc;AACVhC,uCAAe,KADL;AAEVqE,wCAAgB;AACZxC,0CADY;AAEZsC,gDAFY;AAGZC,gDAHY;AAIZE,mCAAOzC,OAAOyC,KAAP,EAJK;AAKZhD;AALY;AAFN,qBAAd;AAUH;AACJ;AACJ;;;0CAEiB;AACd,gBAAMhB,IAAI/C,OAAV;;AADc,2BAEiBE,QAAQ,KAAKwC,IAAb,CAFjB;AAAA;AAAA,gBAEPkE,SAFO;AAAA,gBAEIC,SAFJ;;AAAA,2BAGqC,KAAK5F,KAH1C;AAAA,gBAGNqD,MAHM,YAGNA,MAHM;AAAA,gBAGQ0C,WAHR,YAGE7D,IAHF;AAAA,gBAGqB8D,WAHrB,YAGqBA,WAHrB;;AAKd;;AALc,wCAM2B,KAAKzE,KAAL,CAAWsE,cANtC;AAAA,gBAMN/C,WANM,yBAMNA,WANM;AAAA,gBAMUmD,YANV;;AAQd,gBAAIF,eAAeC,WAAnB,EAAgC;AAC5BA,4BAAYC,YAAZ,EAA0B;AACtBN,wCADsB;AAEtBC,wCAFsB;AAGtBvC;AAHsB,iBAA1B,EAIGvB,CAJH;AAKH;AACJ;;;6CAEoB;AACjB,gBAAMA,IAAI/C,OAAV;;AAEA,gBAAM8C,MAAMvC,SAAS,KAAKmC,IAAd,CAAZ;AACA5C,mBAAOgD,GAAP,EACKF,EADL,CACQhC,SADR,EACmB,IADnB,EAEKgC,EAFL,CAEQ/B,QAFR,EAEkB,IAFlB;;AAJiB,2BAQ6B,KAAKI,KARlC;AAAA,gBAQH+F,WARG,YAQT7D,IARS;AAAA,gBAQUgE,cARV,YAQUA,cARV;;AAUjB;;AAViB,yCAWwB,KAAK3E,KAAL,CAAWsE,cAXnC;AAAA,gBAWT/C,WAXS,0BAWTA,WAXS;AAAA,gBAWOmD,YAXP;;AAajB,gBAAIF,eAAeG,cAAnB,EAAmC;AAC/BA,+BAAeD,YAAf,EAA6BnE,CAA7B;AACH;;AAED,iBAAK0B,QAAL,CAAc;AACVqC,gCAAgB;AADN,aAAd;AAGH;;;uCAEcM,mB,EAAqB;AAChC,gBAAIA,wBAAwB,KAAK5E,KAAL,CAAW4E,mBAAvC,EAA4D;AACxD,qBAAK3C,QAAL,CAAc;AACV2C;AADU,iBAAd;AAGH;AACJ;;;iCAEQ;AAAA,2BACsE,KAAKnG,KAD3E;AAAA,gBACGoG,MADH,YACGA,MADH;AAAA,gBACWC,KADX,YACWA,KADX;AAAA,gBACkBC,EADlB,YACkBA,EADlB;AAAA,gBACsBC,kBADtB,YACsBA,kBADtB;AAAA,gBAC0CC,uBAD1C,YAC0CA,uBAD1C;;AAEL,gBAAMC,YAAY,KAAKlF,KAAL,CAAW4E,mBAAX,IAAkC,IAAlC,GACZ,KAAK5E,KAAL,CAAW4E,mBADC,GAEZ,CAACK,uBAAD,GAA2B,EAA3B,GAAgC,KAAKjF,KAAL,CAAWC,aAAX,GAC5B,4DAD4B,GAE5B,6DAJV;;AAMA,gBAAMkF,mBAAmBH,sBAAsB;AAC3CI,yBAAS,KAAKvG,WAD6B;AAE3CmF,6BAAa,KAAKjF,eAFyB;AAG3C2D,yBAAS,KAAKpD,WAH6B;AAI3CyD,+BAAe,KAAKxD,gBAJuB;AAK3C8F,8BAAc,KAAKnG,gBALwB;AAM3CoG,6BAAa,KAAKnG;AANyB,aAA/C;;AASA,mBACI,uCAAM,KAAK,KAAKU,QAAhB;AACM,2BAAWqF,SADjB;AAEM,uBAAOJ,KAFb;AAGM,wBAAQD,MAHd;AAIM,oBAAIE,EAJV;AAKM,uBAAO,EAAEQ,SAAS,CAAX;AALb,eAMUJ,gBANV,EADJ;AAUH;;;;EA1iBsB/H,S;;AA6iB3B;AACA;;;AAGAoB,aAAagH,SAAb,GAAyB;AACrBhD,eAAWnF,UAAUoI,IAAV,CAAeC,UADL;AAErB/E,UAAMtD,UAAUoI,IAAV,CAAeC,UAFA;AAGrBlC,SAAKnG,UAAUoI,IAAV,CAAeC,UAHC;AAIrBC,wBAAoBtI,UAAUuI,MAAV,CAAiBF,UAJhB;AAKrBvF,WAAO9C,UAAUoI,IAAV,CAAeC,UALD;AAMrBT,6BAAyB5H,UAAUoI,IAAV,CAAeC,UANnB;;AAQrBZ,WAAOzH,UAAUuI,MAAV,CAAiBF,UARH;AASrBb,YAAQxH,UAAUuI,MAAV,CAAiBF,UATJ;AAUrB3D,iBAAa1E,UAAUwI,KAVF;AAWrB/D,YAAQzE,UAAUyI,IAAV,CAAeJ,UAXF;AAYrBK,eAAW1I,UAAUyI,IAAV,CAAeJ,UAZL;AAarBV,wBAAoB3H,UAAUoI,IAAV,CAAeC,UAbd;;AAerBpC,yBAAqBjG,UAAUyI,IAAV,CAAeJ,UAff;;AAiBrBnD,iBAAalF,UAAUyI,IAjBF;AAkBrBtF,kBAAcnD,UAAUyI,IAlBH;AAmBrBpF,kBAAcrD,UAAUyI,IAnBH;AAoBrBlF,YAAQvD,UAAUyI,IApBG;AAqBrBrB,iBAAapH,UAAUyI,IArBF;AAsBrBnB,oBAAgBtH,UAAUyI,IAAV,CAAeJ,UAtBV;AAuBrB7D,WAAOxE,UAAUyI,IAvBI;AAwBrB9C,cAAU3F,UAAUyI,IAxBC;AAyBrB7B,iBAAa5G,UAAUyI,IAzBF;AA0BrB5C,YAAQ7F,UAAUyI,IA1BG;AA2BrBzC,oBAAgBhG,UAAUyI,IA3BL;;AA6BrBpD,aAASrF,UAAUyI,IA7BE;AA8BrBnD,mBAAetF,UAAUyI,IA9BJ;AA+BrB/C,mBAAe1F,UAAUyI,IA/BJ;AAgCrB9B,iBAAa3G,UAAUyI,IAhCF;AAiCrBE,cAAU3I,UAAU6C;AAjCC,CAAzB;;AAoCA1B,aAAayH,YAAb,GAA4B;AACxBzD,eAAW,KADa;AAExB7B,UAAM,KAFkB;AAGxB6C,SAAK,KAHmB;AAIxBmC,wBAAoB,CAJI;AAKxBxF,WAAO,KALiB;AAMxBkD,oBAAgB/E,IANQ;AAOxB0G,wBAAoB;AAPI,CAA5B;;AAUA,eAAexG,YAAf","file":"EventCapture.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { select, event as d3Event, mouse, touches } from \"d3-selection\";\n\nimport {\n    isDefined, mousePosition, touchPosition, getTouchProps,\n    d3Window,\n    MOUSEMOVE, MOUSEUP,\n    MOUSEENTER, MOUSELEAVE,\n    TOUCHMOVE, TOUCHEND,\n    noop\n} from \"./utils\";\nimport { getCurrentCharts } from \"./utils/ChartDataUtil\";\n\n// import { clearTimeout, setTimeout } from \"timers\";\n\nclass EventCapture extends Component {\n    constructor(props) {\n        super(props);\n        this.handleEnter = this.handleEnter.bind(this);\n        this.handleLeave = this.handleLeave.bind(this);\n        this.handleWheel = this.handleWheel.bind(this);\n        this.handleMouseMove = this.handleMouseMove.bind(this);\n        this.handleMouseDown = this.handleMouseDown.bind(this);\n        this.handlePanEnd = this.handlePanEnd.bind(this);\n        this.handlePan = this.handlePan.bind(this);\n        this.handleTouchStart = this.handleTouchStart.bind(this);\n        this.handleTouchMove = this.handleTouchMove.bind(this);\n        this.handlePinchZoom = this.handlePinchZoom.bind(this);\n        this.handlePinchZoomEnd = this.handlePinchZoomEnd.bind(this);\n\n        this.handleClick = this.handleClick.bind(this);\n\n        this.handleRightClick = this.handleRightClick.bind(this);\n        this.handleDrag = this.handleDrag.bind(this);\n        this.handleDragEnd = this.handleDragEnd.bind(this);\n\n        this.shouldPan = this.shouldPan.bind(this);\n        this.canPan = this.canPan.bind(this);\n\n        this.setCursorClass = this.setCursorClass.bind(this);\n        this.saveNode = this.saveNode.bind(this);\n\n        this.mouseInside = false;\n\n        this.mouseInteraction = true;\n        this.state = {\n            panInProgress: false\n        };\n    }\n\n    saveNode(node) {\n        this.node = node;\n    }\n\n    componentWillMount() {\n        this.focus = this.props.focus;\n    }\n\n    componentDidMount() {\n        if (this.node) {\n            select(this.node)\n                .on(MOUSEENTER, this.handleEnter)\n                .on(MOUSELEAVE, this.handleLeave);\n        }\n    }\n\n    componentDidUpdate() {\n        this.componentDidMount();\n    }\n\n    componentWillUnmount() {\n        if (this.node) {\n            select(this.node)\n                .on(MOUSEENTER, null)\n                .on(MOUSELEAVE, null);\n            const win = d3Window(this.node);\n            select(win)\n                .on(MOUSEMOVE, null);\n        }\n    }\n\n    handleEnter() {\n        const e = d3Event;\n\n        const { onMouseEnter } = this.props;\n        this.mouseInside = true;\n        if (!this.state.panInProgress\n            && !this.state.dragInProgress) {\n            const win = d3Window(this.node);\n            select(win)\n                .on(MOUSEMOVE, this.handleMouseMove);\n        }\n        onMouseEnter(e);\n    }\n\n    handleLeave(e) {\n        const { onMouseLeave } = this.props;\n        this.mouseInside = false;\n        if (!this.state.panInProgress\n            && !this.state.dragInProgress) {\n            const win = d3Window(this.node);\n            select(win)\n                .on(MOUSEMOVE, null);\n        }\n        onMouseLeave(e);\n    }\n\n    handleWheel(e) {\n        const { zoom, onZoom } = this.props;\n        const { panInProgress } = this.state;\n\n        const yZoom = Math.abs(e.deltaY) > Math.abs(e.deltaX) && Math.abs(e.deltaY) > 0;\n        // const xPan = Math.abs(e.deltaY) < Math.abs(e.deltaX) && Math.abs(e.deltaX) > 0;\n        const mouseXY = mousePosition(e);\n        e.preventDefault();\n\n        if (zoom && this.focus && yZoom && !panInProgress) {\n            const zoomDir = e.deltaY > 0 ? 1 : -1;\n\n            onZoom(zoomDir, mouseXY, e);\n        } else if (this.focus) {\n            if (this.shouldPan()) {\n                // console.log(\"Do pan now...\")\n                // pan already in progress\n                const {\n                    panStartXScale,\n                    chartsToPan\n                } = this.state.panStart;\n                this.lastNewPos = mouseXY;\n                this.panHappened = true;\n\n                this.dx += e.deltaX;\n                this.dy += e.deltaY;\n                const dxdy = { dx: this.dx, dy: this.dy };\n\n                this.props.onPan(mouseXY, panStartXScale, dxdy, chartsToPan, e);\n            } else {\n                // console.log(\"Pan start...\")\n                // pan start\n\n                const { xScale, chartConfig } = this.props;\n                const currentCharts = getCurrentCharts(chartConfig, mouseXY);\n\n                this.dx = 0;\n                this.dy = 0;\n                this.setState({\n                    panInProgress: true,\n                    panStart: {\n                        panStartXScale: xScale,\n                        panOrigin: mouseXY,\n                        chartsToPan: currentCharts\n                    }\n                });\n            }\n            this.queuePanEnd();\n        }\n    }\n\n    queuePanEnd() {\n        if (isDefined(this.panEndTimeout)) {\n            clearTimeout(this.panEndTimeout);\n        }\n        this.panEndTimeout = setTimeout(() => {\n            this.handlePanEnd();\n        }, 100);\n    }\n\n    handleMouseMove() {\n        const e = d3Event;\n\n        const { onMouseMove, mouseMove } = this.props;\n\n        if (this.mouseInteraction\n            && mouseMove\n            && !this.state.panInProgress) {\n\n            const newPos = mouse(this.node);\n\n            onMouseMove(newPos, \"mouse\", e);\n        }\n    }\n\n    handleClick(e) {\n        const mouseXY = mousePosition(e);\n        const { onClick, onDoubleClick } = this.props;\n\n        if (!this.panHappened && !this.dragHappened) {\n            if (this.clicked) {\n                onDoubleClick(mouseXY, e);\n                this.clicked = false;\n            } else {\n                onClick(mouseXY, e);\n                this.clicked = true;\n                setTimeout(() => {\n                    if (this.clicked) {\n                        this.clicked = false;\n                    }\n                }, 400);\n            }\n        }\n    }\n\n    handleRightClick(e) {\n        e.stopPropagation();\n        e.preventDefault();\n        const { onContextMenu, onPanEnd } = this.props;\n\n        const mouseXY = mousePosition(e, this.node.getBoundingClientRect());\n\n        if (isDefined(this.state.panStart)) {\n            const { panStartXScale, panOrigin, chartsToPan } = this.state.panStart;\n            if (this.panHappened) {\n                onPanEnd(mouseXY, panStartXScale, panOrigin, chartsToPan, e);\n            }\n            const win = d3Window(this.node);\n            select(win)\n                .on(MOUSEMOVE, null)\n                .on(MOUSEUP, null);\n\n            this.setState({\n                panInProgress: false,\n                panStart: null\n            });\n        }\n\n        onContextMenu(mouseXY, e);\n    }\n\n    handleDrag() {\n        const e = d3Event;\n        if (this.props.onDrag) {\n            this.dragHappened = true;\n            const mouseXY = mouse(this.node);\n            this.props.onDrag({\n                startPos: this.state.dragStartPosition,\n                mouseXY\n            }, e);\n        }\n    }\n\n    cancelDrag() {\n        const win = d3Window(this.node);\n        select(win)\n            .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n            .on(MOUSEUP, null);\n\n        this.setState({\n            dragInProgress: false\n        });\n        this.mouseInteraction = true;\n    }\n\n    handleDragEnd() {\n        const e = d3Event;\n        const mouseXY = mouse(this.node);\n\n        const win = d3Window(this.node);\n        select(win)\n            .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n            .on(MOUSEUP, null);\n\n        if (this.dragHappened) {\n            this.props.onDragComplete({\n                mouseXY\n            }, e);\n        }\n\n        this.setState({\n            dragInProgress: false\n        });\n        this.mouseInteraction = true;\n    }\n\n    canPan() {\n        const { getAllPanConditions } = this.props;\n        const { pan: initialPanEnabled } = this.props;\n\n        const {\n            panEnabled,\n            draggable: somethingSelected\n        } = getAllPanConditions()\n            .reduce((returnObj, a) => {\n                return {\n                    draggable: returnObj.draggable || a.draggable,\n                    panEnabled: returnObj.panEnabled && a.panEnabled\n                };\n            }, {\n                draggable: false,\n                panEnabled: initialPanEnabled\n            });\n\n        return {\n            panEnabled,\n            somethingSelected\n        };\n    }\n\n    handleMouseDown(e) {\n        if (e.button !== 0) {\n            return;\n        }\n        const { xScale, chartConfig, onMouseDown } = this.props;\n\n        this.panHappened = false;\n        this.dragHappened = false;\n        this.focus = true;\n\n        if (!this.state.panInProgress\n            && this.mouseInteraction\n        ) {\n\n            const mouseXY = mousePosition(e);\n            const currentCharts = getCurrentCharts(chartConfig, mouseXY);\n            const {\n                panEnabled, somethingSelected\n            } = this.canPan();\n            const pan = panEnabled && !somethingSelected;\n\n            if (pan) {\n                this.setState({\n                    panInProgress: pan,\n                    panStart: {\n                        panStartXScale: xScale,\n                        panOrigin: mouseXY,\n                        chartsToPan: currentCharts\n                    }\n                });\n\n                const win = d3Window(this.node);\n                select(win)\n                    .on(MOUSEMOVE, this.handlePan)\n                    .on(MOUSEUP, this.handlePanEnd);\n\n            } else if (somethingSelected) {\n                this.setState({\n                    panInProgress: false,\n                    dragInProgress: true,\n                    panStart: null,\n                    dragStartPosition: mouseXY\n                });\n                this.props.onDragStart({ startPos: mouseXY }, e);\n                // this.mouseInteraction = false;\n\n                const win = d3Window(this.node);\n                select(win)\n                    .on(MOUSEMOVE, this.handleDrag)\n                    .on(MOUSEUP, this.handleDragEnd);\n            }\n\n            onMouseDown(mouseXY, currentCharts, e);\n        }\n        e.preventDefault();\n    }\n\n    shouldPan() {\n        const { pan: panEnabled, onPan } = this.props;\n        return panEnabled\n            && onPan\n            && isDefined(this.state.panStart);\n    }\n\n    handlePan() {\n        const e = d3Event;\n\n        if (this.shouldPan()) {\n            this.panHappened = true;\n\n            const { panStartXScale, panOrigin, chartsToPan } = this.state.panStart;\n\n            const mouseXY = this.mouseInteraction\n                ? mouse(this.node)\n                : touches(this.node)[0];\n\n            this.lastNewPos = mouseXY;\n            const dx = mouseXY[0] - panOrigin[0];\n            const dy = mouseXY[1] - panOrigin[1];\n\n            this.dx = dx;\n            this.dy = dy;\n\n            this.props.onPan(\n                mouseXY, panStartXScale, { dx, dy }, chartsToPan, e\n            );\n        }\n    }\n\n    handlePanEnd() {\n        const e = d3Event;\n        const { pan: panEnabled, onPanEnd } = this.props;\n\n        if (isDefined(this.state.panStart)) {\n            const { panStartXScale, chartsToPan } = this.state.panStart;\n\n            const win = d3Window(this.node);\n            select(win)\n                .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n                .on(MOUSEUP, null)\n                .on(TOUCHMOVE, null)\n                .on(TOUCHEND, null);\n\n            if (this.panHappened\n                // && !this.contextMenuClicked\n                && panEnabled\n                && onPanEnd) {\n                const { dx, dy } = this;\n\n                // console.log(dx, dy)\n                delete this.dx;\n                delete this.dy;\n                onPanEnd(this.lastNewPos, panStartXScale, { dx, dy }, chartsToPan, e);\n            }\n\n            this.setState({\n                panInProgress: false,\n                panStart: null\n            });\n        }\n    }\n\n    handleTouchMove(e) {\n        const { onMouseMove } = this.props;\n        const touchXY = touchPosition(getTouchProps(e.touches[0]), e);\n        onMouseMove(touchXY, \"touch\", e);\n    }\n\n    handleTouchStart(e) {\n        this.mouseInteraction = false;\n\n        const { pan: panEnabled, chartConfig, onMouseMove } = this.props;\n        const { xScale, onPanEnd } = this.props;\n\n        if (e.touches.length === 1) {\n\n            this.panHappened = false;\n            const touchXY = touchPosition(getTouchProps(e.touches[0]), e);\n            onMouseMove(touchXY, \"touch\", e);\n\n            if (panEnabled) {\n                const currentCharts = getCurrentCharts(chartConfig, touchXY);\n\n                this.setState({\n                    panInProgress: true,\n                    panStart: {\n                        panStartXScale: xScale,\n                        panOrigin: touchXY,\n                        chartsToPan: currentCharts\n                    }\n                });\n\n                const win = d3Window(this.node);\n                select(win)\n                    .on(TOUCHMOVE, this.handlePan, false)\n                    .on(TOUCHEND, this.handlePanEnd, false);\n\n            }\n        } else if (e.touches.length === 2) {\n            // pinch zoom begin\n            // do nothing pinch zoom is handled in handleTouchMove\n            const { panInProgress, panStart } = this.state;\n\n            if (panInProgress && panEnabled && onPanEnd) {\n                const { panStartXScale, panOrigin, chartsToPan } = panStart;\n\n                const win = d3Window(this.node);\n                select(win)\n                    .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n                    .on(MOUSEUP, null)\n                    .on(TOUCHMOVE, this.handlePinchZoom, false)\n                    .on(TOUCHEND, this.handlePinchZoomEnd, false);\n\n                const touch1Pos = touchPosition(getTouchProps(e.touches[0]), e);\n                const touch2Pos = touchPosition(getTouchProps(e.touches[1]), e);\n\n                if (this.panHappened\n                    // && !this.contextMenuClicked\n                    && panEnabled\n                    && onPanEnd) {\n\n                    onPanEnd(this.lastNewPos, panStartXScale, panOrigin, chartsToPan, e);\n                }\n\n                this.setState({\n                    panInProgress: false,\n                    pinchZoomStart: {\n                        xScale,\n                        touch1Pos,\n                        touch2Pos,\n                        range: xScale.range(),\n                        chartsToPan\n                    }\n                });\n            }\n        }\n    }\n\n    handlePinchZoom() {\n        const e = d3Event;\n        const [touch1Pos, touch2Pos] = touches(this.node);\n        const { xScale, zoom: zoomEnabled, onPinchZoom } = this.props;\n\n        // eslint-disable-next-line no-unused-vars\n        const { chartsToPan, ...initialPinch } = this.state.pinchZoomStart;\n\n        if (zoomEnabled && onPinchZoom) {\n            onPinchZoom(initialPinch, {\n                touch1Pos,\n                touch2Pos,\n                xScale\n            }, e);\n        }\n    }\n\n    handlePinchZoomEnd() {\n        const e = d3Event;\n\n        const win = d3Window(this.node);\n        select(win)\n            .on(TOUCHMOVE, null)\n            .on(TOUCHEND, null);\n\n        const { zoom: zoomEnabled, onPinchZoomEnd } = this.props;\n\n        // eslint-disable-next-line no-unused-vars\n        const { chartsToPan, ...initialPinch } = this.state.pinchZoomStart;\n\n        if (zoomEnabled && onPinchZoomEnd) {\n            onPinchZoomEnd(initialPinch, e);\n        }\n\n        this.setState({\n            pinchZoomStart: null\n        });\n    }\n\n    setCursorClass(cursorOverrideClass) {\n        if (cursorOverrideClass !== this.state.cursorOverrideClass) {\n            this.setState({\n                cursorOverrideClass\n            });\n        }\n    }\n\n    render() {\n        const { height, width, id, disableInteraction, useCrossHairStyleCursor } = this.props;\n        const className = this.state.cursorOverrideClass != null\n            ? this.state.cursorOverrideClass\n            : !useCrossHairStyleCursor ? \"\" : this.state.panInProgress\n                ? \"react-stockcharts-cursor react-stockcharts-grabbing-cursor\"\n                : \"react-stockcharts-cursor react-stockcharts-crosshair-cursor\";\n\n        const interactionProps = disableInteraction || {\n            onWheel: this.handleWheel,\n            onMouseDown: this.handleMouseDown,\n            onClick: this.handleClick,\n            onContextMenu: this.handleRightClick,\n            onTouchStart: this.handleTouchStart,\n            onTouchMove: this.handleTouchMove\n        };\n\n        return (\n            <rect ref={this.saveNode}\n                  className={className}\n                  width={width}\n                  height={height}\n                  id={id}\n                  style={{ opacity: 0 }}\n                  {...interactionProps}\n            />\n        );\n    }\n}\n\n// \t\t\t\tonMouseEnter={this.handleEnter}\n//\t\t\t\tonMouseLeave={this.handleLeave}\n\n\nEventCapture.propTypes = {\n    mouseMove: PropTypes.bool.isRequired,\n    zoom: PropTypes.bool.isRequired,\n    pan: PropTypes.bool.isRequired,\n    panSpeedMultiplier: PropTypes.number.isRequired,\n    focus: PropTypes.bool.isRequired,\n    useCrossHairStyleCursor: PropTypes.bool.isRequired,\n\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    chartConfig: PropTypes.array,\n    xScale: PropTypes.func.isRequired,\n    xAccessor: PropTypes.func.isRequired,\n    disableInteraction: PropTypes.bool.isRequired,\n\n    getAllPanConditions: PropTypes.func.isRequired,\n\n    onMouseMove: PropTypes.func,\n    onMouseEnter: PropTypes.func,\n    onMouseLeave: PropTypes.func,\n    onZoom: PropTypes.func,\n    onPinchZoom: PropTypes.func,\n    onPinchZoomEnd: PropTypes.func.isRequired,\n    onPan: PropTypes.func,\n    onPanEnd: PropTypes.func,\n    onDragStart: PropTypes.func,\n    onDrag: PropTypes.func,\n    onDragComplete: PropTypes.func,\n\n    onClick: PropTypes.func,\n    onDoubleClick: PropTypes.func,\n    onContextMenu: PropTypes.func,\n    onMouseDown: PropTypes.func,\n    children: PropTypes.node\n};\n\nEventCapture.defaultProps = {\n    mouseMove: false,\n    zoom: false,\n    pan: false,\n    panSpeedMultiplier: 1,\n    focus: false,\n    onDragComplete: noop,\n    disableInteraction: false\n};\n\nexport default EventCapture;\n"]}